---
id: solution-appendices-postgres
sidebar_position: 2
title: Extra Postgres Tasks
---

:::note
This presumes you already have Postgres deployed and running per this [link](/3-Create/Deploy/postgres.mdx)
:::

## Adding Object Stores

Determine how many databases we need to create. In our example below we will create the following:

Extra object stores
- `os2db`
- `os3db`

FilePlan Object Store and Record Object Store for IER
- `fposdb`
- `rosb`

### Creating the tablespace directories in postgres pod

Determine the name of your postgres pod by first making sure we're in the right namespace:
```tsx
kubectl config set-context --current --namespace=filenet
```
And then pulling a list of pods
```tsx
kubectl get pods | grep postgres
// highlight-next-line
postgres-759fd876ff-d5fxd                     1/1     Running   0          7d22h
```

Now create the tablespace folders on the pod. These will be living in the PVC storage:
```tsx
kubectl exec -it postgres-759fd876ff-d5fxd -- mkdir /pgsqldata/fposdb /pgsqldata/rosdb /pgsqldata/os2db /pgsqldata/os3db
kubectl exec -it postgres-759fd876ff-d5fxd -- chmod 700 /pgsqldata/fposdb /pgsqldata/rosdb /pgsqldata/os2db /pgsqldata/os3db
```

### Create the databases

Connect to `defaultdb`. Our password will be `p@ssw0rd`.

```tsx
kubectl exec -it postgres-759fd876ff-d5fxd -- psql -h localhost -U admin --password -p 5432 defaultdb
```

Create each database listed above. When you run the `\connect` command, it will query you for the password. It will still be `p@ssw0rd`.

With these commands, we will be creating each database, setting the owner to `ceuser`, locking it down from public and then creating the tablespace for that database to use the directories we created above. These tablespaces will live on a separate PVC.

```tsx
CREATE DATABASE os2db OWNER ceuser TEMPLATE template0 ENCODING UTF8;
GRANT ALL ON DATABASE os2db TO ceuser;
REVOKE CONNECT ON DATABASE os2db FROM public;

// highlight-next-line
\connect os2db
CREATE TABLESPACE os2db_tbs OWNER ceuser LOCATION '/pgsqldata/os2db';
GRANT CREATE ON TABLESPACE os2db_tbs TO ceuser;

CREATE DATABASE os3db OWNER ceuser TEMPLATE template0 ENCODING UTF8;
GRANT ALL ON DATABASE os3db TO ceuser;
REVOKE CONNECT ON DATABASE os3db FROM public;

// highlight-next-line
\connect os3db
CREATE TABLESPACE os3db_tbs OWNER ceuser LOCATION '/pgsqldata/os3db';
GRANT CREATE ON TABLESPACE os3db_tbs TO ceuser;

CREATE DATABASE fposdb OWNER ceuser TEMPLATE template0 ENCODING UTF8;
GRANT ALL ON DATABASE fposdb TO ceuser;
REVOKE CONNECT ON DATABASE fposdb FROM public;

// highlight-next-line
\connect fposdb
CREATE TABLESPACE fposdb_tbs OWNER ceuser LOCATION '/pgsqldata/fposdb';
GRANT CREATE ON TABLESPACE fposdb_tbs TO ceuser;

CREATE DATABASE rosdb OWNER ceuser TEMPLATE template0 ENCODING UTF8;
GRANT ALL ON DATABASE rosdb TO ceuser;
REVOKE CONNECT ON DATABASE rosdb FROM public;

// highlight-next-line
\connect rosdb
CREATE TABLESPACE rosdb_tbs OWNER ceuser LOCATION '/pgsqldata/rosdb';
GRANT CREATE ON TABLESPACE rosdb_tbs TO ceuser;

```